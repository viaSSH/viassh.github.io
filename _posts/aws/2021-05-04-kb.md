---
published: true
layout: single
title: "Knowledge battle"
category: BLOG
tags:
  - aws
  - lambda
comments: true
author_profile: false
---




ec2 볼륨 백업 -> EBS 

- 새로운 ebs 생성, 연결
- 기존 EBS 에서 copy
  - Rsync - 좀 느림
  - Tar - 파일 퍼미션 가져오기 실패
  - clone -   clone sync /src /dst --checkers 128 --transfers 128
- https://galid1.tistory.com/360. - ec2에 새로운 ebs mount 하는 방법



1. 누가 내 인스턴스 킨거같은데?  -> 옆에 사람한테 켰냐고 물어봐. 계정관리 잘 하고. Cloudformation, 빈스토크, OpsWork, EMR이 인스턴스를 켤 수 있으니깐 그 서비스들을 사용하면 확인해봐. Cloudtrail로 확인할 수 있어.

2. 좀비 인스턴스야. 계속 살아나는데?  -> 오토스케일링 기능이 기본적으로 들어간 빈스토크를 사용하니? 오토스케일링 그룹을 확인해봐. 

3. EC2 실종사건 -> 님 아이디 맞음? 로그인 제대로했나 확인해. 서울리전 맞니?? 옆에 친구한테 너가 껐냐고 물어봐... 는 비개발자한테 얘기. 개발자라면 오토스케일링이나 빈스토크, 람다가 인스턴스를 껐을수도 있으니깐 Cloudtrail 한번 확인해봐. 스팟인스턴스를 쓰고있었으면 다른 사람이 더 높은 가격으로 비딩했을경우에 인스턴스가 꺼져.

4. 인스턴스를 다른 서브넷, AZ, VPC 로 옮기고싶은데... -> 응 못해. 할라면 AMI 카피해서 마이그레이션하자. EBS 스냅샷을 떠서 그거로 AMI만들면 좀 더 빠를거야.

5. 인터넷게이트웨이를 만들었는데도 ec2가 외부연결이 안돼!  -> 인스턴스 서브넷에 연결된 라우팅 테이블에 0.0.0.0/0 이 있는지 확인해. 보안그룹과 NACL 확인해서 인바운드, 아웃바운드 잘 체크하고. 만약 인스턴스에 퍼블릭 IP가 없어? 그러면 EIP를 할당해서 연결해줘

6. ec2 CPU 크레딧 잔고가 떡락했어. ->. 인스턴스를 중지하면 누적된 모든 크레딧이 사라져 (?) 

7. 람다로 인스턴스 껐다켰다 하고싶은데. ->. Cloudwatch에서 일정시간마다 반복되는 이벤트를 생성하고 그 이벤트에 람다함수를 연결해. 람다함수에서 인스턴스 정보를 입력하여 제어할 수 있어.

8. 인스턴스 상태가 바뀌면 메일로 알려줘. ->. CloudWatch 이벤트를 생성해서 SNS 로 전송할 수 있어 

9. AMI 프라이빗 공유하고싶어. ->  그 사람의 AWS 계정 ID를 알면 교차 계정 AMI 복사 방법을 통해 공유할 수 있어

10. 인스턴스볼륨(EBS?)을 EBS에 백업하고싶어. -> 새로운 EBS 생성하고 그 인스턴스에 연결하고 Mount해서 rsync나 copy 명령어로 데이터 복사해

11. 서울에서 만든 AMI 를 도쿄로 복사하고싶어. -> AMI복사 기능을 활용해. 암호화된 AMI복사도 있다구

12. CLI로 서비스 할당량 늘리고싶어. -> ㅇㅋ 공식문서 참고해 난 코드를 기억못해. 가능한 방법이긴해

13. 공유테넌시 <-> 전용호스트 왔다갔다 하고싶어. ->. humm...뭔소리야

14. ec2에서 메일이 안보내져! 25번 포트!  ->  25번포트 안되면 465,587포트써.  보통 포트25는 메일보낼때 쓰는데 ec2에선 기본적으로 25포트의 아웃바운드 트래픽을 제한해. 그래서 **이메일 전송 제한 제거 요청** 을 서포트케이스 올려서 해결해야돼

15. 이 인스턴스가 AZ d에서 안돼요!!  -> 일부 가용영역은 특정 인스턴스 유형 지원안하기도해

